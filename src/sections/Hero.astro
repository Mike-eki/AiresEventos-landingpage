---
import ArrowDown from "../icons/ArrowDown.astro";
---

<section id="hero">
    <div class="circle-container">
        <!-- Issue: Solo en Safari, este circulo no esta centrado y se desaliena de la viewbox  -->
        <!-- <svg width="192" height="192" viewBox="0 0 100 100">
            <defs>
                <path
                    id="circle"
                    d="
                    M 50, 50
                    m -37, 0
                    a 37,37 0 1,1 74,0
                    a 37,37 0 1,1 -74,0"
                ></path>
            </defs>
            <text textLength="235">
                <textPath href="#circle" startOffset="0">
                    Donde los momentos cobran vida • Donde los momentos cobran
                    vida •
                </textPath>
            </text>
        </svg> -->
        <img class="circle-text-path" src="images/hero-path-text.png" alt="Una imagen de un texto en circulo">
    </div>
    <button id="scroll-button" class="button-hero"><ArrowDown /></button>
    <video autoplay muted loop>
        <source src="videos/hero_video.mp4" type="video/mp4" />
    </video>
</section>

<style>
    section {
        position: relative;
        overflow: hidden;

        display: flex;
        justify-content: center;
        align-items: flex-end;
    }
    .circle-container {
        position: absolute;
        width: 12rem; /* 192px */
        height: 12rem;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 15;
    }
    svg {
        shape-rendering: geometricPrecision;
        width: 100%;
        height: 100%;
        transform-origin: center;
    }

    @keyframes rotate {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    /*  Issue: Solo en Safari, este circulo no esta centrado y se desaliena de la viewbox  --> */
    /* text {
        will-change: transform;
        text-rendering: optimizeLegibility;
        
        transform-origin: center center;
        fill: var(--light-beige);
        font-family: var(--font-switzer-light);
        font-size: 6px;
    } */

    .circle-text-path {
        animation: rotate 20s linear infinite;
    }


    button {
        position: absolute;
        margin-bottom: 44px; /* Medida exacta para que quede centrado en el circulo */
        border-radius: 10rem;
        border: none;
        width: 4rem;
        height: 6.5rem;
        cursor: pointer;
        z-index: 20;
        transition: transform 0.2s ease;
    }

    button:hover {
        transform: scale(1.05);
    }

    button:active {
        transform: scale(0.95);
    }

    video {
        display: block;
        width: 100%;
        height: 100vh;
        height: 100dvh;
        margin: 0;
        padding: 0;
        object-fit: cover;
        z-index: 10;
    }

</style>

<script>
    import { gsap } from "gsap";
    import { ScrollToPlugin } from "gsap/ScrollToPlugin";

    gsap.registerPlugin(ScrollToPlugin);

    document.addEventListener("DOMContentLoaded", () => {
        const button = document.getElementById("scroll-button");

        if (button) {
            button.addEventListener("click", () => {
                const tl = gsap.timeline();

                tl.to(button, {
                    scale: 0.9,
                    duration: 0.3,
                    ease: "power2.out",
                })
                    .to(button, {
                        scale: 1,
                        duration: 0.15,
                        ease: "power2.out",
                    })
                    .to(
                        window,
                        {
                            duration: 0.1 /* Ajustar duración para coherencia */,
                            scrollTo: {
                                y: "#intro",
                                offsetY: 50 /* Usar el offset ya establecido */,
                            },
                            ease: "power3.inOut",
                        },
                        "-=0.1",
                    );
            });
        }
    });
</script>
